//Normale a la patch

RtPoint Normale()
{
 
 RtFloat Xu, Yu, Zu, Xv, Yv, Zv; //Coordonnees des derivees partielles
 RtPoint Norm;
 // w : var globale contenant 4x4 points de controle de la mini-patch  

 Xu = .015625*(w[0][0].x + w[3][0].x + w[0][3].x + w[3][3].x) 
    + .046875*(w[1][0].x + w[2][0].x + w[1][3].x + w[2][3].x 
             + w[0][1].x + w[3][1].x + w[0][2].x + w[3][2].x)
    + .140625*(w[1][1].x + w[2][1].x + w[1][2].x + w[2][2].x);
  
 Yu = .015625*(w[0][0].y + w[3][0].y + w[0][3].y + w[3][3].y) 
    + .046875*(w[1][0].y + w[2][0].y + w[1][3].y + w[2][3].y 
             + w[0][1].y + w[3][1].y + w[0][2].y + w[3][2].y)
    + .140625*(w[1][1].y + w[2][1].y + w[1][2].y + w[2][2].y);
  
 Zu = .015625*(w[0][0].z + w[3][0].z + w[0][3].z + w[3][3].z) 
    + .046875*(w[1][0].z + w[2][0].z + w[1][3].z + w[2][3].z 
             + w[0][1].z + w[3][1].z + w[0][2].z + w[3][2].z)
    + .140625*(w[1][1].z + w[2][1].z + w[1][2].z + w[2][2].z);
  
 Xv = .09375*(-(w[0][0].x + w[1][0].x + w[0][3].x + w[1][3].x) 
              +(w[2][0].x + w[3][0].x + w[2][3].x + w[3][3].x))
    + .28125*(-(w[0][1].x + w[1][1].x + w[0][2].x + w[1][2].x)
              +(w[2][1].x + w[3][1].x + w[2][2].x + w[3][2].x));

 Yv = .09375*(-(w[0][0].y + w[1][0].y + w[0][3].y + w[1][3].y) 
              +(w[2][0].y + w[3][0].y + w[2][3].y + w[3][3].y))
    + .28125*(-(w[0][1].y + w[1][1].y + w[0][2].y + w[1][2].y)
              +(w[2][1].y + w[3][1].y + w[2][2].y + w[3][2].y));

 Zv = .09375*(-(w[0][0].z + w[1][0].z + w[0][3].z + w[1][3].z) 
              +(w[2][0].z + w[3][0].z + w[2][3].z + w[3][3].z))
    + .28125*(-(w[0][1].z + w[1][1].z + w[0][2].z + w[1][2].z)
              +(w[2][1].z + w[3][1].z + w[2][2].z + w[3][2].z));

 Norm.x = Yv*Zu - Zv*Yu;
 Norm.y = -Xv*Zu + Zv*Xu;
 Norm.z = Xv*Yu - Yv*Xu;

 return(Norm);
}


